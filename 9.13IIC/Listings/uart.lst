C51 COMPILER V9.60.0.0   UART                                                              09/13/2025 19:44:20 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE UART
OBJECT MODULE PLACED IN .\Objects\uart.obj
COMPILER INVOKED BY: D:\work\KEIL\ARM\C51\BIN\C51.EXE DRIVER\uart.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\APP;.\DRIVER;.\STC
                    -8HLib) DEBUG OBJECTEXTEND PRINT(.\Listings\uart.lst) TABS(2) OBJECT(.\Objects\uart.obj)

line level    source

   1          #include "type_def.h"
   2          #include "STC8G_H_UART.h"
   3          #include <string.h>
   4          #include "STC8G_H_Delay.h"
   5          #include <stdio.h>
   6          u8 code atarr[]={"AT+TIME="};
   7          extern u8 key1;
   8          void sort(u16 Data[],u8 len)
   9          {
  10   1          u16 i, j, temp;
  11   1          for (i = 0; i < len-1; i++) {
  12   2              for (j = 0; j < len-i-1; j++) {
  13   3                  if (Data[j] > Data[j+1]) {
  14   4                      // 交换arr[j]和arr[j+1]
  15   4                      temp = Data[j];
  16   4                      Data[j] = Data[j+1];
  17   4                      Data[j+1] = temp;
  18   4                      
  19   4                  }
  20   3              }
  21   2          }
  22   1      }
  23          
  24          /**
  25          ***********************************************************
  26          * @brief   串口1发送 串口2接收
  27          * @param 
  28          * @return  
  29          ***********************************************************
  30          */
  31          void uart1tx_uart2rx()
  32          {
  33   1          u8 i;
  34   1      
  35   1        if(COM1.RX_TimeOut > 0)   //超时计数
  36   1            {
  37   2              if(--COM1.RX_TimeOut == 0)
  38   2              {
  39   3                if(COM1.RX_Cnt > 0)
  40   3                {
  41   4            
  42   4                  //TX2_write2buff(COM1.RX_Cnt);  //串口2读取串口1数据后计算串口1发来数据的数量
  43   4                  
  44   4                  //sort(RX1_Buffer,COM1.RX_Cnt); //实现串口1发送来的数据，进行排序后，
  45   4                  
  46   4                  for(i=0; i<COM1.RX_Cnt; i++)  TX2_write2buff(RX1_Buffer[i]);  //收到的数据原样返回
  47   4                }                               //串口2发送串口1发送来的数据返回给串口1
  48   3                COM1.RX_Cnt = 0;
  49   3              }
  50   2            }
  51   1        
  52   1        if(COM2.RX_TimeOut > 0)   //超时计数
  53   1            {
  54   2              if(--COM2.RX_TimeOut == 0)
C51 COMPILER V9.60.0.0   UART                                                              09/13/2025 19:44:20 PAGE 2   

  55   2              {
  56   3                if(COM2.RX_Cnt > 0)
  57   3                {
  58   4                  //TX1_write2buff(COM2.RX_Cnt);
  59   4                  //sort(RX2_Buffer,COM2.RX_Cnt);
  60   4                  for(i=0; i<COM2.RX_Cnt; i++)  TX1_write2buff(RX2_Buffer[i]);  //收到的数据原样返回
  61   4                }
  62   3                COM2.RX_Cnt = 0;
  63   3              }
  64   2          }
  65   1            
  66   1            
  67   1          
  68   1            
  69   1      }
  70                
  71          
  72          
  73           
  74          
  75          
  76          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    335    ----
   CONSTANT SIZE    =      9    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       8
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
