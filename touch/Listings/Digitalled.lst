C51 COMPILER V9.60.0.0   DIGITALLED                                                        09/15/2025 11:19:29 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE DIGITALLED
OBJECT MODULE PLACED IN .\Objects\Digitalled.obj
COMPILER INVOKED BY: D:\work\KEIL\ARM\C51\BIN\C51.EXE DRIVER\Digitalled.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\APP;.\DRIVER
                    -;.\STC8HLib) DEBUG OBJECTEXTEND PRINT(.\Listings\Digitalled.lst) TABS(2) OBJECT(.\Objects\Digitalled.obj)

line level    source

   1          #include "config.h"
   2          #include "STC8G_H_Delay.h"
   3          #define   SER595  P41
   4          #define   RCK595  P76
   5          #define   SCK595  P77
   6          //extern u8 encoder_count1;
   7          //extern u8 encoder_count2;
   8          u8 i;
   9          u8 code TableDU[]={0x3f,0x06,0x5b,0x4f,
  10                             0x66,0x6d,0x7d,0x07,
  11                             0x7f,0x6f,0x77,0x7c,
  12                             0x39,0x5e,0x79,0x00};
  13          u8 code TableWE[]={0xfe,0xfd,0xfb,0xf7,0xef,0xdf,0xbf,0x7f};  
  14          
  15          
  16          
  17          /**
  18          ***********************************************************
  19          * @brief 驱动595，写一个字节
  20          * @param 
  21          * @return 
  22          ***********************************************************
  23          */
  24          void Hc595WriteByte(u8 Data)
  25          {
  26   1        u8 k;
  27   1        for(k=0;k<8;k++)
  28   1        {
  29   2          SCK595=0;
  30   2          Data=Data<<1;
  31   2          SER595=CY;
  32   2          SCK595=1;
  33   2        }
  34   1      }
  35          /**
  36          ***********************************************************
  37          * @brief 让74H595输出
  38          * @param 
  39          * @return 
  40          ***********************************************************
  41          */
  42          void DisplayNum(u8 num,u8 dat)
  43          {
  44   1        
  45   1        Hc595WriteByte(TableDU[dat]);//必须先送段
  46   1        Hc595WriteByte(TableWE[num-1]);
  47   1        RCK595=0;
  48   1        RCK595=1;
  49   1      }
  50          /**
  51          ***********************************************************
  52          * @brief 显示任意5位数，65535以内
  53          * @param disnum，要显示的数字
  54          * @return 
C51 COMPILER V9.60.0.0   DIGITALLED                                                        09/15/2025 11:19:29 PAGE 2   

  55          ***********************************************************
  56          */
  57          //void DisplayAny1_Num(u32 disnum);
  58          //{
  59          //  long xdata qianwan,baiwan,shiwan,wan,qian,bai,shi,ge;
  60          //  qianwan=disnum/10000000;
  61          //  baiwan=disnum%10000000/1000000;
  62          //  shiwan=disnum%1000000/100000;
  63          //  wan = disnum %100000 /10000;
  64          //  qian = disnum % 10000 / 1000;
  65          //  bai = disnum % 1000 / 100;
  66          //  shi = disnum % 100 / 10;
  67          //  ge = disnum % 10;
  68          //  if(qianwan != 0)
  69          //  {
  70          //    DisplayNum(1,qianwan);
  71          //    delay_ms(1);
  72          //  }
  73          //  if((baiwan != 0)||(shiwan!=0))
  74          //  {
  75          //    DisplayNum(2,baiwan);
  76          //    delay_ms(1);
  77          //  } 
  78          //  if((shiwan != 0)||(baiwan != 0)||(qianwan != 0))
  79          //  {
  80          //    DisplayNum(3,shiwan);
  81          //    delay_ms(1);
  82          //  }
  83          //    
  84          //  if((wan != 0)||(shiwan!=0)||(baiwan != 0)||(qianwan != 0))
  85          //  {     
  86          //      DisplayNum(4,wan);
  87          //      delay_ms(1);
  88          //  }
  89          //  if((qian != 0) ||  (wan != 0)||(shiwan!=0)||(baiwan != 0)||(qianwan != 0))
  90          //  {       
  91          //      DisplayNum(5,qian);
  92          //      delay_ms(1);
  93          //  }
  94          //  if((bai != 0) || (qian != 0) || (wan != 0)||(shiwan!=0)||(baiwan != 0)||(qianwan != 0))
  95          //  {   
  96          //    DisplayNum(6,bai);
  97          //    delay_ms(1);
  98          //  }
  99          //   if((shi != 0) ||(bai != 0) || (qian != 0) || (wan != 0)||(baiwan != 0)||(shiwan!=0)||(qianwan != 0))
 100          //   {
 101          //     DisplayNum(7,shi);
 102          //     delay_ms(1);
 103          //   }  
 104          //    
 105          ////    if(ge<0)
 106          ////   {
 107          ////     
 108          ////     DisplayNum(8,ge);
 109          ////   }
 110          //     if(((encoder_count2-encoder_count1)/20)>0)
 111          //     {
 112          //       DisplayNum(7,16);
 113          //           delay_ms(1);
 114          
 115          //     }
 116          //     DisplayNum(8,ge);
C51 COMPILER V9.60.0.0   DIGITALLED                                                        09/15/2025 11:19:29 PAGE 3   

 117          //  
 118          //}
 119          
 120          
 121           void DisplayAnyNum(u16 disnum)
 122          {
 123   1        u8 wan,qian,bai,shi,ge;
 124   1        wan = disnum / 10000;
 125   1        qian = disnum % 10000 / 1000;
 126   1        bai = disnum % 1000 / 100;
 127   1        shi = disnum % 100 / 10;
 128   1        ge = disnum % 10; 
 129   1        if(wan != 0)
 130   1        {
 131   2          DisplayNum(4,wan);
 132   2          delay_ms(1);
 133   2        }
 134   1          if((qian != 0) ||  (wan != 0))
 135   1        {
 136   2          DisplayNum(5,qian);
 137   2          delay_ms(1);
 138   2        }
 139   1            if((bai != 0) || (qian != 0) || (wan != 0))
 140   1        {
 141   2          DisplayNum(6,bai);
 142   2          delay_ms(1);
 143   2        }
 144   1          if((shi != 0) ||(bai != 0) || (qian != 0) || (wan != 0))  
 145   1        {
 146   2          DisplayNum(7,shi);
 147   2          delay_ms(1);
 148   2        }
 149   1          DisplayNum(8,ge);
 150   1          //delay_ms(10);
 151   1      }
 152          
 153          //void test_display(u8 disnum)
 154          //{   
 155          //    i++;
 156          //    DisplayNum(i,disnum);
 157          //    delay_ms(10);   
 158          //    if(i>=8)
 159          //    {
 160          //      i=0;
 161          //      delay_ms(10);     
 162          //    }
 163          //}
 164          
 165          
 166          
 167          
 168          
 169          
 170          
 171          
 172          
 173          
 174          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    257    ----
C51 COMPILER V9.60.0.0   DIGITALLED                                                        09/15/2025 11:19:29 PAGE 4   

   CONSTANT SIZE    =     24    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1       5
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
